-- workflow=test_rand_model
--  period=1440
--  loadType=incremental
--  logDrivenType=timewindow

-- step=1
-- source=pmml
--  className=com.github.sharpdata.sharpetl.spark.extension.PmmlUDF
--  pmmlFileName=test_rand_model.pmml
-- target=udf
--  methodName=predict
--  udfName=predict

-- step=2
-- source=hive
-- target=temp
--  tableName=temp1
select cast(1.0 as float) as x1,
       cast(1.0 as float) as x2,
       cast(1.0 as float) as x3,
       cast(1.0 as float) as x4,
       cast(1.0 as float) as x5,
       cast(1.0 as float) as x6,
       cast(1.0 as float) as x7,
       cast(1.0 as float) as x8,
       cast(1.0 as float) as x9,
       cast(1.0 as float) as x10,
       cast(1.0 as float) as x11,
       cast(1.0 as float) as x12,
       cast(1.0 as float) as x13,
       cast(1.0 as float) as x14,
       cast(1.0 as float) as x15,
       cast(1.0 as float) as x16,
       cast(1.0 as float) as x17,
       cast(1.0 as float) as x18,
       cast(1.0 as float) as x19,
       cast(1.0 as float) as x20,
       cast(1.0 as float) as x21,
       cast(1.0 as float) as x22,
       cast(1.0 as float) as x23,
       cast(1.0 as float) as x25,
       cast(1.0 as float) as x26,
       cast(1.0 as float) as x27,
       cast(1.0 as float) as x28,
       cast(1.0 as float) as x29,
       cast(1.0 as float) as x30,
       cast(1.0 as float) as x31,
       cast(1.0 as float) as x32,
       cast(1.0 as float) as x34,
       cast(1.0 as float) as x35,
       cast(1.0 as float) as x36,
       cast(1.0 as float) as x37,
       cast(1.0 as float) as x38,
       cast(1.0 as float) as x39,
       cast(1.0 as float) as x40,
       cast(1.0 as float) as x41,
       cast(1.0 as float) as x42,
       cast(1.0 as float) as x43,
       cast(1.0 as float) as x44,
       cast(1.0 as float) as x45,
       cast(1.0 as float) as x46,
       cast(1.0 as float) as x47,
       cast(1.0 as float) as x48,
       cast(1.0 as float) as x49,
       cast(1.0 as float) as x50,
       cast(1.0 as float) as x51,
       cast(1.0 as float) as x52,
       cast(1.0 as float) as x53,
       cast(1.0 as float) as x54,
       cast(1.0 as float) as x55,
       cast(1.0 as float) as x56,
       cast(1.0 as float) as x58,
       cast(1.0 as float) as x59,
       cast(1.0 as float) as x60,
       cast(1.0 as float) as x61,
       cast(1.0 as float) as x62,
       cast(1.0 as float) as x63,
       cast(1.0 as float) as x65,
       cast(1.0 as float) as x66,
       cast(1.0 as float) as x67,
       cast(1.0 as float) as x68,
       cast(1.0 as float) as x69,
       cast(1.0 as float) as x70,
       cast(1.0 as float) as x71,
       cast(1.0 as float) as x72,
       cast(1.0 as float) as x73,
       cast(1.0 as float) as x74,
       cast(1.0 as float) as x75,
       cast(1.0 as float) as x76,
       cast(1.0 as float) as x77,
       cast(1.0 as float) as x78,
       cast(1.0 as float) as x79,
       cast(1.0 as float) as x80,
       cast(1.0 as float) as x81,
       cast(1.0 as float) as x85,
       cast(1.0 as float) as x86,
       cast(1.0 as float) as x87,
       cast(1.0 as float) as x88,
       cast(1.0 as float) as x89,
       cast(1.0 as float) as x90,
       cast(1.0 as float) as x91,
       cast(1.0 as float) as x92,
       cast(1.0 as float) as x93,
       cast(1.0 as float) as x94,
       cast(1.0 as float) as x95,
       cast(1.0 as float) as x96,
       cast(1.0 as float) as x97,
       cast(1.0 as float) as x98,
       cast(1.0 as float) as x99,
       cast(1.0 as float) as x100;

-- step=3
-- source=temp
-- target=temp
--  tableName=temp2
select predict(
               struct(
                       x1,
                       x2,
                       x3,
                       x4,
                       x5,
                       x6,
                       x7,
                       x8,
                       x9,
                       x10,
                       x11,
                       x12,
                       x13,
                       x14,
                       x15,
                       x16,
                       x17,
                       x18,
                       x19,
                       x20,
                       x21,
                       x22,
                       x23,
                       x25,
                       x26,
                       x27,
                       x28,
                       x29,
                       x30,
                       x31,
                       x32,
                       x34,
                       x35,
                       x36,
                       x37,
                       x38,
                       x39,
                       x40,
                       x41,
                       x42,
                       x43,
                       x44,
                       x45,
                       x46,
                       x47,
                       x48,
                       x49,
                       x50,
                       x51,
                       x52,
                       x53,
                       x54,
                       x55,
                       x56,
                       x58,
                       x59,
                       x60,
                       x61,
                       x62,
                       x63,
                       x65,
                       x66,
                       x67,
                       x68,
                       x69,
                       x70,
                       x71,
                       x72,
                       x73,
                       x74,
                       x75,
                       x76,
                       x77,
                       x78,
                       x79,
                       x80,
                       x81,
                       x85,
                       x86,
                       x87,
                       x88,
                       x89,
                       x90,
                       x91,
                       x92,
                       x93,
                       x94,
                       x95,
                       x96,
                       x97,
                       x98,
                       x99,
                       x100
                   )
           ) as target,
       x1,
       x2,
       x3,
       x4,
       x5,
       x6,
       x7,
       x8,
       x9,
       x10,
       x11,
       x12,
       x13,
       x14,
       x15,
       x16,
       x17,
       x18,
       x19,
       x20,
       x21,
       x22,
       x23,
       x25,
       x26,
       x27,
       x28,
       x29,
       x30,
       x31,
       x32,
       x34,
       x35,
       x36,
       x37,
       x38,
       x39,
       x40,
       x41,
       x42,
       x43,
       x44,
       x45,
       x46,
       x47,
       x48,
       x49,
       x50,
       x51,
       x52,
       x53,
       x54,
       x55,
       x56,
       x58,
       x59,
       x60,
       x61,
       x62,
       x63,
       x65,
       x66,
       x67,
       x68,
       x69,
       x70,
       x71,
       x72,
       x73,
       x74,
       x75,
       x76,
       x77,
       x78,
       x79,
       x80,
       x81,
       x85,
       x86,
       x87,
       x88,
       x89,
       x90,
       x91,
       x92,
       x93,
       x94,
       x95,
       x96,
       x97,
       x98,
       x99,
       x100
from temp1;

-- step=4
-- source=temp
-- target=console
select cast(target['y'] as int)                 as target,
       cast(target['probability(0)'] as double) as probability_0,
       cast(target['probability(1)'] as double) as probability_1,
       x1,
       x2,
       x3,
       x4,
       x5,
       x6,
       x7,
       x8,
       x9,
       x10,
       x11,
       x12,
       x13,
       x14,
       x15,
       x16,
       x17,
       x18,
       x19,
       x20,
       x21,
       x22,
       x23,
       x25,
       x26,
       x27,
       x28,
       x29,
       x30,
       x31,
       x32,
       x34,
       x35,
       x36,
       x37,
       x38,
       x39,
       x40,
       x41,
       x42,
       x43,
       x44,
       x45,
       x46,
       x47,
       x48,
       x49,
       x50,
       x51,
       x52,
       x53,
       x54,
       x55,
       x56,
       x58,
       x59,
       x60,
       x61,
       x62,
       x63,
       x65,
       x66,
       x67,
       x68,
       x69,
       x70,
       x71,
       x72,
       x73,
       x74,
       x75,
       x76,
       x77,
       x78,
       x79,
       x80,
       x81,
       x85,
       x86,
       x87,
       x88,
       x89,
       x90,
       x91,
       x92,
       x93,
       x94,
       x95,
       x96,
       x97,
       x98,
       x99,
       x100
from temp2;